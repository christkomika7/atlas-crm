generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  USER
}

enum ContractType {
  CLIENT
  LESSOR
}

enum NotificationType {
  ALERT
  CONFIRM
}

enum NotificationKindOf {
  INVOICE
  PURCHASE_ORDER
  QUOTE
  PAYMENT
  DELIVERY_NOTE
  RECEIPT
  DISBURSEMENT
  APPOINTMENT
  PROJECT
  TASK
}

enum DeletionType {
  QUOTES
  INVOICES
  DELIVERY_NOTES
  PURCHASE_ORDERS
  RECEIPTS
  DISBURSEMENTS
  PRODUCT_SERVICES
  BILLBOARDS
  CLIENTS
  SUPPLIERS
  PROJECTS
  CONTRACT
  APPOINTMENTS
}

enum SourceType {
  CASH
  BANK
  WITHDRAWAL
}

enum Resource {
  DASHBOARD
  CLIENTS
  SUPPLIERS
  INVOICES
  QUOTES
  DELIVERY_NOTES
  PURCHASE_ORDER
  CREDIT_NOTES
  PRODUCT_SERVICES
  BILLBOARDS
  PROJECTS
  APPOINTMENT
  TRANSACTION
  SETTING
  CONTRACT
  UNKNOWN_RESOURCE
}

enum ItemState {
  IGNORE
  APPROVED
  PURCHASE
}

enum TransactionType {
  RECEIPT
  DISBURSEMENT
}

enum LessorSpace {
  PUBLIC
  PRIVATE
}

enum Action {
  READ
  CREATE
  MODIFY
}

enum Priority {
  URGENT
  NORMAL
  RELAX
}

enum ProjectStatus {
  TODO
  IN_PROGRESS
  DONE
  BLOCKED
}

enum ProductServiceType {
  PRODUCT
  SERVICE
}

enum BankTransaction {
  INFLOWS
  OUTFLOWS
}

enum AmountType {
  HT
  TTC
}

enum ItemInvoiceType {
  INVOICES
  QUOTES
  DELIVERY_NOTES
  PURCHASE_ORDERS
  CREDIT_NOTES
}

model Company {
  id                         String                @id @default(uuid())
  companyName                String                @unique
  country                    String
  city                       String
  codePostal                 String
  registeredAddress          String
  phoneNumber                String
  email                      String
  website                    String?
  businessRegistrationNumber String
  taxIdentificationNumber    String
  niu                        String?               @default("")
  legalForms                 String                @default("")
  capitalAmount              String
  currency                   String
  bankAccountDetails         String
  businessActivityType       String
  fiscalYearStart            DateTime
  fiscalYearEnd              DateTime
  vatRates                   Json
  createdAt                  DateTime              @default(now())
  updatedAt                  DateTime              @updatedAt
  documentModel              DocumentModel?
  clients                    Client[]
  appointments               Appointment[]
  projects                   Project[]
  suppliers                  Supplier[]
  productsServices           ProductService[]
  billboards                 Billboard[]
  cities                     City[]
  areas                      Area[]
  invoices                   Invoice[]
  billboardTypes             BillboardType[]
  transactionCategories      TransactionCategory[]
  transactionNatures         TransactionNature[]
  allocations                Allocation[]
  sources                    Source[]
  receipts                   Receipt[]
  dibursements               Dibursement[]
  quotes                     Quote[]
  recurrences                Recurrence[]
  purchaseOrders             PurchaseOrder[]
  deliveryNotes              DeliveryNote[]
  items                      Item[]
  displayBoards              DisplayBoard[]
  structureTypes             StructureType[]
  lessorTypes                LessorType[]
  deletions                  Deletion[]
  contracts                  Contract[]
  fiscalObjects              FiscalObject[]
  profiles                   Profile[]
  notifications              Notification[]

  @@unique([email])
  @@map("company")
}

model User {
  id    String @id @default(uuid())
  name  String
  email String @unique
  role  Role?  @default(USER)

  emailVerified  Boolean
  currentCompany String?
  currentProfile String?

  sessions Session[]
  accounts Account[]
  profiles Profile[]

  banned     Boolean?
  banReason  String?
  banExpires DateTime?

  updatedAt      DateTime        @updatedAt
  createdAt      DateTime        @default(now())
  deletions      Deletion[]
  invoices       Invoice[]
  purchaseOrders PurchaseOrder[]
  quotes         Quote[]
  deliveryNotes  DeliveryNote[]
  notifications  Notification[]

  @@map("user")
}

model Profile {
  id        String  @id @default(uuid())
  key       Int     @default(autoincrement())
  role      Role?   @default(USER)
  firstname String
  lastname  String
  image     String?
  path      String  @default("")

  phone String?

  job    String
  salary String

  internalRegulations String?
  passport            String?

  banned     Boolean?
  banReason  String?
  banExpires DateTime?

  permissions  Permission[]
  appointments Appointment[]
  projects     Project[]     @relation("project_collaborators")
  tasks        Task[]        @relation("task_users")
  dibursements Dibursement[]

  companyId String?
  company   Company? @relation(fields: [companyId], references: [id], onDelete: Cascade)

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("profile")
}

model Supplier {
  id                         String   @id @default(uuid())
  companyName                String   @unique
  firstname                  String
  hasDelete                  Boolean  @default(false)
  lastname                   String
  phone                      String
  email                      String
  businessSector             String
  website                    String?
  paidAmount                 Decimal  @default(0) @db.Decimal(15, 2)
  due                        Decimal  @default(0) @db.Decimal(15, 2)
  job                        String?  @default("")
  legalForms                 String   @default("")
  capital                    String?  @default("0")
  address                    String
  businessRegistrationNumber String
  taxIdentificationNumber    String
  discount                   String
  paymentTerms               String
  information                String?
  path                       String
  uploadDocuments            String[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  billboards     Billboard[]
  purchaseOrders PurchaseOrder[]
  receipts       Receipt[]
  dibursements   Dibursement[]
  contracts      Contract[]

  @@map("supplier")
}

model Client {
  id                         String   @id @default(uuid())
  companyName                String
  lastname                   String
  hasDelete                  Boolean  @default(false)
  firstname                  String
  email                      String
  phone                      String
  website                    String?
  address                    String
  path                       String?
  paidAmount                 Decimal  @default(0) @db.Decimal(15, 2)
  due                        Decimal  @default(0) @db.Decimal(15, 2)
  businessSector             String
  businessRegistrationNumber String
  taxIdentificationNumber    String
  job                        String?  @default("")
  legalForms                 String   @default("")
  capital                    String?  @default("0")
  discount                   String
  paymentTerms               String
  information                String?
  uploadDocuments            String[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  appointments Appointment[]

  projects      Project[]
  invoices      Invoice[]
  billboards    Billboard[]
  quotes        Quote[]
  deliveryNotes DeliveryNote[]
  receipts      Receipt[]
  dibursements  Dibursement[]
  contracts     Contract[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("client")
}

model Appointment {
  id             String   @id @default(uuid())
  subject        String
  address        String
  hasDelete      Boolean  @default(false)
  date           DateTime
  time           String
  notify         Boolean  @default(false)
  email          String
  path           String
  documents      String[]
  teamMemberName String

  notifications Notification[]

  clientId String
  client   Client @relation(fields: [clientId], references: [id], onDelete: Cascade)

  teamMemberId String?
  teamMember   Profile? @relation(fields: [teamMemberId], references: [id], onDelete: SetNull)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("appointment")
}

model Contract {
  id             String       @id @default(uuid())
  contractNumber Int          @default(autoincrement())
  type           ContractType
  hasDelete      Boolean      @default(false)

  clientId String?
  client   Client? @relation(fields: [clientId], references: [id], onDelete: SetNull)

  lessorId String?
  lessor   Supplier? @relation(fields: [lessorId], references: [id], onDelete: SetNull)

  lessorType String?

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  invoices Invoice[]

  billboardId String?
  billboard   Billboard? @relation(fields: [billboardId], references: [id], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("contract")
}

model Billboard {
  id String @id @default(uuid())

  reference      String        @unique
  hasTax         Boolean       @default(false)
  typeId         String
  hasDelete      Boolean       @default(false)
  type           BillboardType @relation(fields: [typeId], references: [id], onDelete: Cascade)
  name           String
  locality       String
  areaId         String
  area           Area          @relation(fields: [areaId], references: [id], onDelete: Cascade)
  visualMarker   String
  displayBoardId String
  displayBoard   DisplayBoard  @relation(fields: [displayBoardId], references: [id])

  // Emplacement
  cityId      String
  city        City   @relation(fields: [cityId], references: [id], onDelete: Cascade)
  orientation String
  gmaps       String

  // Brochure
  pathPhoto    String
  pathBrochure String
  photos       String[]
  brochures    String[]

  // Donn√©e financiere
  rentalPrice      Decimal @default(0) @db.Decimal(15, 2)
  installationCost Decimal @default(0) @db.Decimal(15, 2)
  maintenance      Decimal @default(0) @db.Decimal(15, 2)
  revenueGenerate  Decimal @default(0) @db.Decimal(15, 2)

  // Information technique

  width             Float
  height            Float
  lighting          String
  structureType     StructureType @relation(fields: [structureTypeId], references: [id])
  structureTypeId   String
  panelCondition    String
  decorativeElement String
  foundations       String
  electricity       String
  framework         String
  note              String

  // Information bailleur
  lessorSpaceType  String
  lessorSupplierId String?
  lessorSupplier   Supplier?  @relation(fields: [lessorSupplierId], references: [id], onDelete: SetNull)
  lessorTypeId     String
  lessorType       LessorType @relation(fields: [lessorTypeId], references: [id])

  lessorName              String?
  lessorAddress           String?
  lessorCity              String?
  lessorPhone             String?
  lessorEmail             String?
  identityCard            String?
  capital                 Decimal? @default(0) @db.Decimal(15, 2)
  niu                     String?  @default("")
  legalForms              String   @default("")
  rccm                    String?
  taxIdentificationNumber String?
  bankName                String?
  rib                     String?
  iban                    String?
  bicSwift                String?

  /// Information representant legal
  representativeFirstName String?
  representativeLastName  String?
  representativeJob       String?
  representativePhone     String?
  representativeEmail     String?

  // Detail du contrat
  rentalStartDate    DateTime?
  delayContractStart DateTime?
  delayContractEnd   DateTime?
  locationPrice      String?
  nonLocationPrice   String?
  rentalPeriod       String?
  paymentMode        String?
  paymentFrequency   String?
  electricitySupply  String?
  specificCondition  String?

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  clientId String?
  client   Client? @relation(fields: [clientId], references: [id])

  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  invoices      Invoice[]
  items         Item[]
  quotes        Quote[]
  deliveryNotes DeliveryNote[]
  contracts     Contract[]

  @@map("billboard")
}

model Invoice {
  id            String     @id @default(uuid())
  invoiceNumber Int        @default(autoincrement())
  hasDelete     Boolean    @default(false)
  note          String
  files         String[]
  pathFiles     String
  totalHT       Decimal    @default(0) @db.Decimal(15, 2)
  discount      String
  discountType  String
  paymentLimit  String
  totalTTC      Decimal    @default(0) @db.Decimal(15, 2)
  payee         Decimal    @default(0) @db.Decimal(15, 2)
  isPaid        Boolean    @default(false)
  amountType    AmountType @default(TTC)

  createdById String?
  createdBy   User?   @relation(fields: [createdById], references: [id], onDelete: Cascade)

  clientId String?
  client   Client? @relation(fields: [clientId], references: [id], onDelete: Cascade)

  fromRecordReference String @default("")
  fromRecordId        String @default("")
  fromRecordName      String @default("")

  productsServices ProductService[]
  billboards       Billboard[]
  items            Item[]
  receipts         Receipt[]
  dibursements     Dibursement[]
  payments         Payment[]
  recurrences      Recurrence[]
  contracts        Contract[]
  notifications    Notification[]

  projectId String?
  project   Project? @relation(fields: [projectId], references: [id], onDelete: Cascade)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("invoice")
}

model PurchaseOrder {
  id                  String     @id @default(uuid())
  purchaseOrderNumber Int        @default(autoincrement())
  note                String
  hasDelete           Boolean    @default(false)
  files               String[]
  pathFiles           String
  totalHT             Decimal    @default(0) @db.Decimal(15, 2)
  discount            String
  discountType        String
  paymentLimit        String
  totalTTC            Decimal    @default(0) @db.Decimal(15, 2)
  payee               Decimal    @default(0) @db.Decimal(15, 2)
  isPaid              Boolean    @default(false)
  amountType          AmountType @default(TTC)

  createdById String?
  createdBy   User?   @relation(fields: [createdById], references: [id], onDelete: Cascade)

  supplierId String?
  supplier   Supplier? @relation(fields: [supplierId], references: [id], onDelete: Cascade)

  productsServices ProductService[]
  items            Item[]
  dibursements     Dibursement[]
  payments         Payment[]
  recurrences      Recurrence[]
  notifications    Notification[]

  projectId String?
  project   Project? @relation(fields: [projectId], references: [id], onDelete: Cascade)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("purchase_order")
}

model Quote {
  id           String     @id @default(uuid())
  quoteNumber  Int        @default(autoincrement())
  hasDelete    Boolean    @default(false)
  note         String
  files        String[]
  pathFiles    String
  amountType   AmountType @default(TTC)
  totalHT      Decimal    @default(0) @db.Decimal(15, 2)
  discount     String
  discountType String
  paymentLimit String
  totalTTC     Decimal    @default(0) @db.Decimal(15, 2)
  isCompleted  Boolean    @default(false)

  fromRecordReference String @default("")
  fromRecordId        String @default("")
  fromRecordName      String @default("")

  createdById String?
  createdBy   User?   @relation(fields: [createdById], references: [id], onDelete: Cascade)

  clientId String?
  client   Client? @relation(fields: [clientId], references: [id], onDelete: Cascade)

  productsServices ProductService[]
  billboards       Billboard[]
  items            Item[]
  notifications    Notification[]

  projectId String?
  project   Project? @relation(fields: [projectId], references: [id], onDelete: Cascade)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("quote")
}

model DeliveryNote {
  id                 String     @id @default(uuid())
  deliveryNoteNumber Int        @default(autoincrement())
  hasDelete          Boolean    @default(false)
  note               String
  files              String[]
  pathFiles          String
  amountType         AmountType @default(TTC)
  totalHT            Decimal    @default(0) @db.Decimal(15, 2)
  discount           String
  discountType       String
  paymentLimit       String
  totalTTC           Decimal    @default(0) @db.Decimal(15, 2)
  isCompleted        Boolean    @default(false)

  fromRecordReference String @default("")
  fromRecordId        String @default("")
  fromRecordName      String @default("")

  createdById String?
  createdBy   User?   @relation(fields: [createdById], references: [id], onDelete: Cascade)

  clientId String?
  client   Client? @relation(fields: [clientId], references: [id], onDelete: Cascade)

  productsServices ProductService[]
  billboards       Billboard[]
  items            Item[]
  notifications    Notification[]

  projectId String?
  project   Project? @relation(fields: [projectId], references: [id], onDelete: Cascade)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("delivery_note")
}

model Recurrence {
  id     String @id @default(uuid())
  repeat String

  invoiceId String?
  invoice   Invoice? @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  purchaseOrderId String?
  purchaseOrder   PurchaseOrder? @relation(fields: [purchaseOrderId], references: [id])

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("recurrence")
}

model Payment {
  id          String  @id @default(uuid())
  amount      Decimal @default(0) @db.Decimal(15, 2)
  paymentMode String
  infos       String?

  invoiceId String?
  invoice   Invoice? @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  purchaseOrderId String?
  purchaseOrder   PurchaseOrder? @relation(fields: [purchaseOrderId], references: [id])

  updatedAt   DateTime     @updatedAt
  createdAt   DateTime     @default(now())
  receipt     Receipt?
  dibursement Dibursement?

  @@map("payment")
}

model Item {
  id              String          @id @default(uuid())
  reference       String          @default("")
  state           ItemState       @default(APPROVED)
  hasTax          Boolean         @default(false)
  name            String
  description     String?
  quantity        Float
  price           Decimal         @default(0) @db.Decimal(15, 2)
  updatedPrice    Decimal         @default(0) @db.Decimal(15, 2)
  discount        String
  discountType    String
  currency        String
  itemType        String
  locationStart   DateTime
  locationEnd     DateTime
  itemInvoiceType ItemInvoiceType @default(INVOICES)

  invoiceId String?
  invoice   Invoice? @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  quoteId String?
  quote   Quote?  @relation(fields: [quoteId], references: [id], onDelete: Cascade)

  billboardId String?
  billboard   Billboard? @relation(fields: [billboardId], references: [id], onDelete: SetNull)

  productServiceId String?
  productService   ProductService? @relation(fields: [productServiceId], references: [id], onDelete: SetNull)

  purchaseOrder   PurchaseOrder? @relation(fields: [purchaseOrderId], references: [id])
  purchaseOrderId String?

  deliveryNoteId String?
  deliveryNote   DeliveryNote? @relation(fields: [deliveryNoteId], references: [id])

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("item")
}

model Project {
  id                 String          @id @default(uuid())
  name               String          @unique
  deadline           DateTime
  hasDelete          Boolean         @default(false)
  projectInformation String?
  amount             Decimal         @default(0) @db.Decimal(15, 2)
  balance            Decimal         @default(0) @db.Decimal(15, 2)
  files              String[]
  path               String
  status             ProjectStatus   @default(BLOCKED)
  clientId           String
  client             Client          @relation(fields: [clientId], references: [id], onDelete: Cascade)
  companyId          String
  company            Company         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  collaborators      Profile[]       @relation("project_collaborators")
  tasks              Task[]
  invoices           Invoice[]
  quotes             Quote[]
  purchaseOrders     PurchaseOrder[]
  deliveryNotes      DeliveryNote[]
  dibursements       Dibursement[]
  notifications      Notification[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("project")
}

model Task {
  id            String         @id @default(uuid())
  taskName      String
  desc          String
  path          String?
  time          DateTime
  priority      Priority       @default(NORMAL)
  comment       String
  file          String[]
  status        ProjectStatus  @default(TODO)
  projectId     String
  project       Project        @relation(fields: [projectId], references: [id], onDelete: Cascade)
  users         Profile[]      @relation("task_users")
  steps         TaskStep[]
  notifications Notification[]

  @@map("task")
}

model TaskStep {
  id       String  @id @default(uuid())
  stepName String
  check    Boolean @default(false)

  taskId String
  task   Task   @relation(fields: [taskId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("task_step")
}

model City {
  id   String @id @default(uuid())
  name String @unique

  billboards Billboard[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  areas     Area[]

  @@map("city")
}

model Area {
  id         String      @id @default(uuid())
  name       String      @unique
  billboards Billboard[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  cityId String
  city   City   @relation(fields: [cityId], references: [id], onDelete: Cascade)

  @@map("area")
}

model BillboardType {
  id         String      @id @default(uuid())
  name       String      @unique
  billboards Billboard[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("billboard_type")
}

model DisplayBoard {
  id         String      @id @default(uuid())
  name       String      @unique
  billboards Billboard[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("display_board")
}

model StructureType {
  id         String      @id @default(uuid())
  name       String      @unique
  billboards Billboard[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("structure_type")
}

model LessorType {
  id         String      @id @default(uuid())
  type       LessorSpace @default(PRIVATE)
  name       String      @unique
  billboards Billboard[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("lessor_type")
}

model DocumentModel {
  id             String  @id @default(uuid())
  logo           String?
  position       String
  size           String
  primaryColor   String
  secondaryColor String

  quotesPrefix        String?
  invoicesPrefix      String?
  deliveryNotesPrefix String?
  purchaseOrderPrefix String?

  quotesInfo        String?
  invoicesInfo      String?
  deliveryNotesInfo String?
  purchaseOrderInfo String?

  companyId String  @unique
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("company_documents")
}

model Receipt {
  id        String          @id @default(uuid())
  type      TransactionType @default(RECEIPT)
  hasDelete Boolean         @default(false)
  reference Int             @default(autoincrement())
  date      DateTime
  movement  BankTransaction @default(INFLOWS)

  categoryId String
  category   TransactionCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  natureId String
  nature   TransactionNature @relation(fields: [natureId], references: [id], onDelete: Cascade)

  amount     Decimal    @default(0) @db.Decimal(15, 2)
  amountType AmountType @default(HT)

  paymentType String
  checkNumber String?

  referenceInvoiceId String?
  referenceInvoice   Invoice? @relation(fields: [referenceInvoiceId], references: [id], onDelete: SetNull)

  sourceId String?
  source   Source? @relation(fields: [sourceId], references: [id], onDelete: SetNull)

  description String?
  comment     String?

  clientId String?
  client   Client? @relation(fields: [clientId], references: [id], onDelete: SetNull)

  supplierId String?
  supplier   Supplier? @relation(fields: [supplierId], references: [id], onDelete: SetNull)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  paymentId String?  @unique
  payment   Payment? @relation(fields: [paymentId], references: [id], onDelete: SetNull)

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  @@map("receipt")
}

model Dibursement {
  id        String          @id @default(uuid())
  type      TransactionType @default(DISBURSEMENT)
  hasDelete Boolean         @default(false)
  reference Int             @default(autoincrement())
  date      DateTime
  movement  BankTransaction @default(OUTFLOWS)

  categoryId String
  category   TransactionCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  natureId String
  nature   TransactionNature @relation(fields: [natureId], references: [id], onDelete: Cascade)

  amount     Decimal    @default(0) @db.Decimal(15, 2)
  amountType AmountType @default(HT)

  periodStart DateTime?
  periodEnd   DateTime?

  paymentType String
  checkNumber String?

  referenceInvoiceId String?
  referenceInvoice   Invoice? @relation(fields: [referenceInvoiceId], references: [id], onDelete: SetNull)

  referencePurchaseOrderId String?
  referencePurchaseOrder   PurchaseOrder? @relation(fields: [referencePurchaseOrderId], references: [id])

  allocationId String?
  allocation   Allocation? @relation(fields: [allocationId], references: [id], onDelete: Cascade)

  sourceId String?
  source   Source? @relation(fields: [sourceId], references: [id], onDelete: SetNull)

  payOnBehalfOfId String?
  payOnBehalfOf   Profile? @relation(fields: [payOnBehalfOfId], references: [id], onDelete: SetNull)

  description String?
  comment     String?

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  clientId String?
  client   Client? @relation(fields: [clientId], references: [id], onDelete: SetNull)

  projectId String?
  project   Project? @relation(fields: [projectId], references: [id], onDelete: Cascade)

  supplierId String?
  supplier   Supplier? @relation(fields: [supplierId], references: [id], onDelete: SetNull)

  fiscalObjectId String?
  fiscalObject   FiscalObject? @relation(fields: [fiscalObjectId], references: [id], onDelete: SetNull)

  paymentId String?  @unique
  payment   Payment? @relation(fields: [paymentId], references: [id], onDelete: SetNull)

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  @@map("dibursement")
}

model Source {
  id   String @id @default(ulid())
  name String

  sourceType SourceType @default(CASH)

  companyId    String
  company      Company       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  receipts     Receipt[]
  dibursements Dibursement[]

  @@map("source")
}

model FiscalObject {
  id           String        @id @default(ulid())
  name         String
  dibursements Dibursement[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  @@map("fiscal_object")
}

model TransactionCategory {
  id           String              @id @default(ulid())
  name         String
  type         TransactionType     @default(RECEIPT)
  natures      TransactionNature[]
  receipts     Receipt[]
  dibursements Dibursement[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  @@map("transaction_category")
}

model TransactionNature {
  id   String @id @default(uuid())
  name String

  categoryId String
  category   TransactionCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  receipts     Receipt[]
  dibursements Dibursement[]
  allocations  Allocation[]

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("transaction_nature")
}

model Allocation {
  id   String @id @default(ulid())
  name String

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  natureId String
  nature   TransactionNature @relation(fields: [natureId], references: [id], onDelete: Cascade)

  dibursements Dibursement[]

  @@map("allocation")
}

model Deletion {
  id         String       @id @default(uuid())
  type       DeletionType
  recordId   String       @unique
  isValidate Boolean      @default(false)

  userId String?
  user   User?   @relation(fields: [userId], references: [id], onDelete: Cascade)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  @@map("deletion")
}

model Notification {
  id     String             @id @default(uuid())
  type   NotificationType   @default(ALERT)
  active Boolean            @default(true)
  for    NotificationKindOf

  paymentId String?
  payment   PaymentData? @relation(fields: [paymentId], references: [id], onDelete: Cascade)

  receiptId String?
  receipt   ReceiptData? @relation(fields: [receiptId], references: [id], onDelete: Cascade)

  dibursementId String?
  dibursement   DibursementData? @relation(fields: [dibursementId], references: [id], onDelete: Cascade)

  invoiceId String?
  invoice   Invoice? @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  quoteId String?
  quote   Quote?  @relation(fields: [quoteId], references: [id], onDelete: Cascade)

  deliveryNoteId String?
  deliveryNote   DeliveryNote? @relation(fields: [deliveryNoteId], references: [id], onDelete: Cascade)

  purchaseOrderId String?
  purchaseOrder   PurchaseOrder? @relation(fields: [purchaseOrderId], references: [id], onDelete: Cascade)

  appointmentId String?
  appointment   Appointment? @relation(fields: [appointmentId], references: [id], onDelete: Cascade)

  projectId String?
  project   Project? @relation(fields: [projectId], references: [id], onDelete: Cascade)

  taskId String?
  task   Task?   @relation(fields: [taskId], references: [id], onDelete: Cascade)

  userId String?
  user   User?   @relation(fields: [userId], references: [id], onDelete: Cascade)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  @@map("notification")
}

model PaymentData {
  id            String         @id @default(uuid())
  amount        Decimal        @default(0) @db.Decimal(15, 2)
  paymentMode   String
  infos         String?
  invoice       String?
  purchaseOrder String?
  notifications Notification[]

  @@map("payment_data")
}

model ReceiptData {
  id          String     @id @default(uuid())
  date        DateTime
  category    String
  nature      String
  amount      Decimal    @default(0) @db.Decimal(15, 2)
  amountType  AmountType @default(HT)
  paymentType String
  checkNumber String?
  invoice     String?
  source      String?
  description String?
  comment     String?
  client      String?
  supplier    String?

  notifications Notification[]

  @@map("receipt_data")
}

model DibursementData {
  id          String     @id @default(uuid())
  date        DateTime
  category    String
  nature      String
  amount      Decimal    @default(0) @db.Decimal(15, 2)
  amountType  AmountType @default(HT)
  periodStart DateTime?
  periodEnd   DateTime?

  paymentType   String
  checkNumber   String?
  purchaseOrder String?

  allocation    String?
  source        String?
  payOnBehalfOf String?
  description   String?
  comment       String?
  client        String?
  supplier      String?
  project       String?
  fiscalObject  String?

  notifications Notification[]

  @@map("dibursement_data")
}

model Permission {
  id        String   @id @default(uuid())
  profile   Profile  @relation(fields: [profileId], references: [id], onDelete: Cascade)
  profileId String
  resource  Resource
  actions   Action[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([profileId, resource])
  @@map("permission")
}

model Session {
  id        String   @id @default(uuid())
  expiresAt DateTime
  token     String

  ipAddress      String?
  userAgent      String?
  userId         String
  user           User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  impersonatedBy String?

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  @@unique([token])
  @@map("session")
}

model Account {
  id                    String    @id @default(uuid())
  accountId             String    @default(uuid())
  providerId            String    @default(uuid())
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  updatedAt             DateTime  @updatedAt
  createdAt             DateTime  @default(now())

  @@map("account")
}

model Verification {
  id         String    @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime?
  updatedAt  DateTime?

  @@map("verification")
}

model RateLimit {
  id          String  @id
  key         String?
  count       Int?
  lastRequest BigInt?

  @@map("rateLimit")
}

model ProductService {
  id          String             @id @default(uuid())
  type        ProductServiceType @default(PRODUCT)
  hasTax      Boolean            @default(false)
  hasDelete   Boolean            @default(false)
  reference   String
  category    String
  designation String
  description String
  unitPrice   Decimal            @default(0) @db.Decimal(15, 2)
  cost        Decimal            @default(0) @db.Decimal(15, 2)
  unitType    String
  quantity    Int                @default(0)

  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  invoices       Invoice[]
  items          Item[]
  quotes         Quote[]
  purchaseOrders PurchaseOrder[]
  deliveryNotes  DeliveryNote[]

  @@map("product_service")
}
